"use strict";(self.webpackChunkmercury_template=self.webpackChunkmercury_template||[]).push([[231],{750:function(e,t,n){n.r(t),n.d(t,{init:function(){return o}});class l{constructor(e,t){const n=t.dataset.action,l=t.dataset.itemId,c=t.dataset.contentId,o=e.querySelector("#"+n+"_button_"+l),s=new URLSearchParams(location.search).get("formmanage");o.addEventListener("click",(()=>{t.showModal()})),t.addEventListener("close",(()=>{"confirm"==t.returnValue&&(location.href="?formmanage="+s+"&action="+n+"&uuid="+c)}))}}class c{constructor(e){this.m_buttonExportCsv=e.querySelector(".btn-export-csv"),this.m_buttonExportExcel=e.querySelector(".btn-export-excel"),this.m_itemSelectStart=e.querySelector(".acco-item-select-start"),this.m_itemSelectAll=e.querySelector(".acco-item-select-all"),this.m_itemSelectNone=e.querySelector(".acco-item-select-none"),this.m_checkbox=e.querySelectorAll(".acco-item-check");this.m_buttonExportCsv&&this.m_buttonExportExcel&&this.m_itemSelectStart&&this.m_itemSelectAll&&this.m_itemSelectNone&&(this.m_buttonExportCsv.addEventListener("click",(e=>this.onExport(e))),this.m_buttonExportExcel.addEventListener("click",(e=>this.onExport(e))),this.m_itemSelectStart.addEventListener("click",(e=>this.onSelectStart(e))),this.m_itemSelectAll.addEventListener("click",(e=>this.onSelectAll(e))),this.m_itemSelectNone.addEventListener("click",(e=>this.onSelectNone(e))),this.m_itemSelectAll.style.display="none",this.m_itemSelectNone.style.display="none")}createHttpRequest(e){const t=new XMLHttpRequest;return t.open("POST",e,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.responseType="arraybuffer",t}getCheckedItemIds(){let e=[];return this.m_checkbox.forEach((t=>{t.checked&&e.push(t.value)})),e}onSelectStart(e){e.preventDefault(),this.m_itemSelectStart.style.display="none",this.m_itemSelectAll.style.display="inline-block",this.m_itemSelectNone.style.display="inline-block",this.m_checkbox.forEach((e=>{e.style.display="inline-block"}))}onSelectAll(e){e.preventDefault(),this.selectAll(!0)}onSelectNone(e){e.preventDefault(),this.selectAll(!1)}onExport(e){e.preventDefault();const t=this.getCheckedItemIds(),n=this.createHttpRequest(e.target.href),l=this.m_checkbox.length==t.length?"":"formdata="+t.join(",");n.send(l),console.log(n),console.log(l),n.onload=function(){const e=this.getResponseHeader("Content-Type"),t=this.getResponseHeader("Content-Disposition");let n="download";t.includes("filename=")&&(n=t.substring(t.indexOf("filename=")+9));const l=this.response,c=new Blob([l],{type:e});c.name=n;const o=new FileReader;o.onload=e=>{const t=document.createElement("a");t.style.display="none",t.href=e.target.result,t.download=n,t.click()},o.readAsDataURL(c)}}selectAll(e){this.m_checkbox.forEach((t=>{t.checked=e}))}}function o(){document.querySelectorAll(".formdata-manage").forEach((e=>{new c(e);e.querySelectorAll(".submissions-dialog").forEach((t=>{new l(e,t)}))}))}}}]);
//# sourceMappingURL=mercury-formdata-manage.js.map